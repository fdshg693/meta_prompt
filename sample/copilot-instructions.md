# 共通指示 - 全エージェント共通設定

## 🎯 基本原則
- **単一責任**: 各エージェントは明確に定義された専門領域のみを担当
- **データ駆動**: 設定ファイルとデータに基づく処理実行
- **品質保証**: 各段階での品質チェックと検証を実施
- **継続性**: エラー時でも可能な限り処理を継続し、有用な結果を出力

## 📋 実行時共通ルール

### ファイル操作規則
- **絶対パス使用**: 全てのファイル操作で絶対パスを使用
- **安全な上書き**: 既存ファイル上書き前に確認メッセージを表示
- **エンコーディング**: UTF-8での読み書きを基本とする
- **権限チェック**: ファイル読み書き権限を事前確認

### エラーハンドリング
- **詳細ログ**: エラー発生時は詳細情報をログファイルに記録
- **段階的回復**: 部分的失敗でも処理可能な範囲で継続
- **ユーザー通知**: 重要なエラーはユーザーに分かりやすく報告
- **自動復旧**: 可能な場合は自動的にエラー状態からの復旧を試行

### データ品質管理
- **入力検証**: 全ての入力データの形式・内容を検証
- **中間確認**: 処理中間段階でのデータ整合性チェック
- **出力検証**: 最終出力の品質と完全性を確認
- **メタデータ**: 処理過程の情報をメタデータとして保存

## 🔄 変数システム活用
- プロンプト内では `{{変数名}}` 形式で変数を参照
- 動的な値は variables.yaml から読み込み
- 実行時パラメータは適切に置換処理

## 📊 ログ出力要求
**毎回の実行終了後に、以下の内容をログファイルに書き込むこと:**
- **ログファイル**: `agents/log_1.txt`, `agents/log_2.txt`, ...
- **ファイル制限**: 300行を超えたら新しいファイルを作成
- **必須記録項目**:
  - **実行日時**: YYYY-MM-DD HH:MM:SS
  - **エージェント名**: 実行したエージェントの名前  
  - **出力ファイル一覧**: 作成したファイルの一覧
  - **処理統計**: 処理したファイル数、成功/失敗件数
  - **実行時間**: 処理開始から終了までの時間
  - **エラー概要**: 発生したエラーの概要（エラーが発生した場合）

## 📋 ワークスペース情報管理
**毎回の実行時に以下の情報管理を実施すること:**
- **実行開始時**: `agents/info.md`の内容を確認し、現在のワークスペース状況を把握
- **実行終了時**: 必要に応じて`agents/info.md`を更新
  - OS・プログラミング言語のインストール状況
  - 依存関係の状態変更
  - プロジェクト進捗状況
  - 注意点や制約事項の更新
- **情報制限**: 最大200行以内で必要最低限の情報のみを記載

## 💾 一時ファイル管理
- **temp/ディレクトリ**: 各実行開始時に内容をクリア
- **中間状態保存**: 長時間処理では進捗を一時ファイルに保存
- **リソース監視**: メモリ使用量を監視し、必要に応じて中間ファイルを活用

## 🔗 エージェント間連携
- **データ引継ぎ**: 前段階の出力ファイルを適切に読み込み
- **状態確認**: 依存する前段階の処理完了を確認
- **整合性保持**: エージェント間でのデータ整合性を維持

## ⚠️ 制約事項
- **プログラミング禁止**: AIプロンプトによる処理のみを使用
- **リソース制限**: 設定ファイルで指定されたリソース制限を遵守
- **セキュリティ**: 機密情報の適切な取り扱いを実施
- **実行時間**: 長時間実行を避け、適切なタイムアウト設定を適用
